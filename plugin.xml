<?xml version='1.0' encoding='utf-8'?>
<plugin id="cordova.appclips.plugin" version="1.0"
	xmlns="http://apache.org/cordova/ns/plugins/1.0"
	xmlns:android="http://schemas.android.com/apk/res/android">
	
	<name>CDVAppClips</name>
	
	<js-module name="CDVAppClips" src="www/CDVAppClips.js">
		<clobbers target="cordova.plugins.appclips" />
	</js-module>

	<!-- URL to open in WebView Instant App -->
	 <preference name="APP_INSTANT_CLIPS_URL"/>
	 <preference name="CREDENTIALS"/>
	 <preference name="WEBSERVICEURL"/>

	<platform name="ios">
		<preference name="PROVISIONING_PROFILES"/>
		<hook type="before_plugin_install" src="hooks/install_custom_xcode_lib.js" />
		<hook type="before_plugin_install" src="hooks/install_prerequisites.js" />
		<hook type="after_plugin_add" src="hooks/add_swift_support.js" />

		<hook type="before_plugin_install" src="hooks/copyAndUnzipProvisioningProfiles.js"/>        
        <hook type="after_plugin_install" src="hooks/copyAppClipFolderToIosProjectFolder.js"/>
        <hook type="after_prepare" src="hooks/copyProvisioningProfiles.js"/>
        <hook type="after_plugin_install" src="hooks/addAppClipToProject.js"/>
        <hook type="after_plugin_install" src="hooks/updateAppClipXcconfig.js"/> <!--after_prepare -->
        <hook type="after_prepare" src="hooks/configureAppClipPlist.js"/> <!--after_prepare -->
        <!--<hook type="after_prepare" src="hooks/fixAppEntitlements.js"/> -->
        <hook type="before_build" src="hooks/updateCordovaBuildJs.js"/> <!--after_prepare -->
        <hook type="after_prepare" src="hooks/update_config_xml.js"/>
        <hook type="after_plugin_install" src="hooks/ios_entitlements_fix.js"/>
        <hook type="before_plugin_install" src="hooks/update_preference_plugin.js"/>
        <!--<hook type="after_plugin_add" src="hooks/set_app_clip_appid.js"/> after_prepare -->

		<!--<hook type="after_plugin_install" src="scripts/iOS_add_target.js" />
		<hook type="after_plugin_install" src="scripts/fixAppEntitlements.js" />
		<hook type="after_plugin_install" src="scripts/copyExtensionFolderToIosProjectFolder.js" />-->

		<config-file target="config.xml" parent="/*">
	        <preference name="PROVISIONING_PROFILES" value="--PLACEHOLDER--" />
	    </config-file>

		<config-file parent="/*" target="config.xml">
			<feature name="CDVAppClips">
				<param name="ios-package" value="CDVAppClips" />
			</feature>
		</config-file>
	</platform>

	<platform name="android">

		<config-file parent="/*" target="res/xml/config.xml">
            <feature name="CDVAppClips">
                <param name="android-package" value="com.outsystems.experts.appclips.CDVAppClips" />
            </feature>

        </config-file>

		<hook type="after_plugin_install" src="hooks/moveInstantApp.js"/>
		<hook type="after_plugin_install" src="hooks/updateInstantAppUrl.js"/>

		<hook type="after_compile" src="hooks/registerInstantAppSettingsGralde.js"/>
		<!-- <hook type="after_plugin_install" src="hooks/generateInstantAppBundle.js"/> -->

		<!-- Check how execute upload after generated build AAB -->
		<!-- <hook type="after_compile" src="hooks/UploadBinary.js" /> -->

		<!-- Variables strings -->
       	<config-file target="instant-app/src/main/res/values/strings.xml" parent="/*">
            <string name="app_instant_clips_url">$APP_INSTANT_CLIPS_URL</string>
        </config-file>
        <!-- End Variables -->
		
	</platform>
</plugin>